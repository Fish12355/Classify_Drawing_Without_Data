# Classify Drawing – Конволутивна Невронска Мрежа

## Опис на моделот
Classify Drawing моделот е конволутивна невронска мрежа која е наменета за препознавање и класификација на цртежи на канвас од 100 избрани класи, при што за секоја класа се користат по 1000 слики за тренирање. Податочното множество е преземено во .npy формат, кое потоа се нормализира и обликува во соодветен формат за работа со димензии на слики 28×28 пиксели. Потоа се прави мешање (shuffle) на целиот dataset и се дели на три дела: тренинг сет, валидациски сет и тест сет (80% / 10% / 10%). Пред да започне вистинското учење, се користи data augmentation, со што сликите благо се поместуваат и им се додава шум со цел моделот да стане поотпорен на варијации кога ќе се тестира.

## Архитектура на невронската мрежа
Како што рековме, невронската мрежа се состои од 3 конволутивни блокови, каде секој блок има Conv2D слоеви за извлекување карактеристики, MaxPooling слој за намалување на дадените димензии и Dropout за спречување на overfitting. Со секој следен блок, бројот на филтри се зголемува, што му овозможува на моделот да учи сè посложени визуелни шаблони. По третиот конволутивен блок, карактеристиките се сплескуваат и се обработуваат преку густ (Dense) слој, кој служи како финален интерпретатор на веќе изучените информации. Излезниот слој користи Softmax активација за да ја даде веројатноста за секоја од 100-те класи.

## Тренирање и евалуација
Моделот се тренира со Adam оптимизатор и sparse categorical crossentropy loss, при што loss-от постепено се намалува и моделот сè подобро ги учи податоците во секоја епоха. Паралелно се следи и точноста (accuracy) на тренинг и валидацискиот сет за да се провери дали моделот генерализира добро. По завршување на тренирањето, моделот се евалуира на тест сет за да се добие реална мерка за неговите перформанси. Најдобрите перформанси што ги има моделот се движат околу 85–90% точност без појава на overfitting.

## Класификација во реално време (Canvas)
Кога корисникот црта на канвасот, секое движење на глувчето се снима како координати, со што точно се знае каде постои нацртаниот објект. Од тие координати се пресметува bounding box, односно најмалиот правоаголник што го опфаќа целиот цртеж, за да не се обработува празниот простор околу него. Потоа тој дел од канвасот се копира во нов, привремен канвас и се претвора во слика која ќе му се даде на моделот. Сликата се рескалира на 28×28 пиксели – димензиите што ги очекува и самиот модел.

## Preprocessing на сликата
При preprocessing чекорот, пикселите се претвораат во нијанси на сива боја и се инвертираат, односно црните линии стануваат бели, а белата позадина станува црна. Потоа вредностите на пикселите се нормализираат во опсег од 0 до 1, што му помага на моделот полесно и постабилно да прави пресметки. Обработената слика се претвора во tensor со форма [1, 28, 28, 1] и се испраќа директно до невронската мрежа, односно моделот.

## Прикажување на резултатите
Моделот враќа низа од веројатности за сите 100 класи, каде секоја вредност кажува колкава е шансата цртежот да припаѓа на таа класа. Овие резултати се сортираат и се земаат топ 5 најверојатни класи. Тие визуелно се прикажуваат преку pie chart, каде секој дел од кругот ја претставува веројатноста за одредена класа. Покрај графикот, се прикажува и легенда со имињата на класите и процентите, со што корисникот јасно може да види како моделот „размислува“.

## 100-те избрани класи
airplane, alarm clock, angel, ant, anvil, apple, arm, axe, banana, basketball, bat, bathtub, beach, bear, bed, bicycle, bird, birthday cake, book, bowtie, bread, broom, bus, butterfly, cactus, car, carrot, castle, cat, circle, clock, cloud, cookie, crab, crown, diamond, dog, donut, door, dragon, drums, duck, ear, eye, fish, flower, fork, grapes, grass, guitar, hamburger, hat, headphones, hot dog, house, ice cream, key, knife, ladder, lantern, light bulb, lollipop, mermaid, monkey, moon, mouse, mug, mushroom, nose, ocean, octopus, owl, paintbrush, palm tree, panda, pear, pizza, rabbit, rain, rainbow, sandwich, saw, scissors, sea turtle, sheep, shovel, skateboard, skull, skyscraper, snowman, spider, square, star, strawberry, submarine, sun, tree, triangle, umbrella, whale

## Користени извори
- Идеја за проект: https://medium.com/tensorflow/train-on-google-colab-and-run-on-the-browser-a-case-study-8a45f9b1474e  
- .npy dataset: https://console.cloud.google.com/storage/browser/quickdraw_dataset/full/numpy_bitmap  
- Останати извори: https://github.com/googlecreativelab/quickdraw-dataset
